# richiamiamo la libreria raster, precedentemente installata con install.packages("raster"):
library(raster)

# scarico i dati su cui voglio lavorare, mettendoli in un percorso corto nel PC: cartella "lab"
# setto la cartella di lavoro, visto che su R non si possono salvare le immagini raster:
setwd("C:/Users/sofia/Desktop/lab")
# NB windows mette le sbarrette invertite

# importiamo i dati su R con la funzione brick() e diamo un nome alla funzione: "l2011"
l2011 <- brick("p224r63_2011_masked.grd")
# ora che ho importato i dati, digitando il nome assegnato prima, usciranno tutti i dati relativi all'immagine:
l2011

# vediamo come plottare un'immagine su R tramite la funzione plot():
plot(l2011)

# cambiamo la legenda dei colori con la funzione colorRampPalette() (NB attenzione alle maiuscole perchè r è case sensitive)
# prendiamo i nomi assegnati ai colori su su r: http://r-graph-gallery.com/42-colors-names.html
# e diamo un nome alla nostra nuova palette per es. "cl":
cl <- colorRampPalette(c("red","orange","yellow"))(100) # 100 è il numero di sfumature desiderato
# "col" è l'argomento da inserire nella funzione plot per plottare l'immagine nei colori appena scelti
plot(l2011, col=cl)
# ottengo la visualizzazione di ogni banda con questa nuova palette di colori

# vogliamo plottare una sola banda:
# b1= blu
# b2= verde
# b3= rosso
# b4= NIR (infrarosso vicino)
plot(l2011[[4]], col=cl) # col=cl per plottarla nella palette di colori scelta da me prima, sennò la plotta nei colori preimpostati
# altro modo:
plot(l2011$B4_sre, col=cl) 

# plotto la banda del blu in 3 tonalità di blu presenti nella palette di r:
clb <- colorRampPalette(c("darkblue","blue","cyan"))(100)
plot(l2011$B1_sre, col=clb)

# esportiamo l'immagine appena ricavata, in formato PDF, nella catrtella lab, con la funzione pdf():
pdf("banda1.pdf")
plot(l2011$B1_sre, col=clb)
dev.off() # per chiudere la finestra dove ho plottato la banda, una volta che ho salvato il mio PDF
# stessa cosa per salvare in png:
pdf("banda1.png")
plot(l2011$B1_sre, col=clb)

# come plottare più immagini insieme, ad es più bande: blu e verde
# intanto creo la mia palette verde per la banda verde
clg <- colorRampPalette(c("darkgreen","green","lightgreen"))(100)
plot(l2011$B2_sre, col=clg)
# apriamo un multiframe con la funzione par()
par(mfrow=c(1,2))
# inseriamo le bande che vogliamo plottare
clb <- colorRampPalette(c("darkblue","blue","cyan"))(100)
plot(l2011$B1_sre, col=clb)
clg <- colorRampPalette(c("darkgreen","green","lightgreen"))(100)
plot(l2011$B2_sre, col=clg)

# se voglio esportare in pdf il multiframe:
pdf("banda 1 e 2".pdf)
par(mfrow=c(1,2))
clb <- colorRampPalette(c("darkblue","blue","cyan"))(100)
plot(l2011$B1_sre, col=clb)
clg <- colorRampPalette(c("darkgreen","green","lightgreen"))(100)
plot(l2011$B2_sre, col=clg)

# se voglio plottare invertendo il multiframe:
par(mfrow=c(2,1))
clb <- colorRampPalette(c("darkblue","blue","cyan"))(100)
plot(l2011[[1]], col=clb)
clg <- colorRampPalette(c("darkgreen","green","lightgreen"))(100) 
plot(l2011[[2]], col=clg)

# faccio il plot delle prime 4 bande (blu, verde, rosso, NIR)
par(mfrow=c(2,2))
# blu
clb <- colorRampPalette(c("darkblue","blue","cyan"))(100)
plot(l2011[[1]], col=clb)
# verde
clg <- colorRampPalette(c("darkgreen","green","lightgreen"))(100) 
plot(l2011[[2]], col=clg)
# rosso
clr <- colorRampPalette(c("coral3","coral1","coral"))(100) 
plot(l2011[[3]], col=clr)
# NIR (viola)
clnir <- colorRampPalette(c("darkorchid4","darkorchid2","darkorchid4"))(100) 
plot(l2011[[4]], col=clnir)

